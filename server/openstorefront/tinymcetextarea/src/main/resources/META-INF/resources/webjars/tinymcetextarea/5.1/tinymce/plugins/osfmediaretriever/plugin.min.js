
tinymce.PluginManager.add("osfmediaretriever",function(b){var d;var c=function c(g){var f=document.createElement("html");f.innerHTML=g.getContent();var e=f.getElementsByTagName("img");return e};var a=new Ext.util.DelayedTask(function(){var e=c(b);d.grid.getStore().removeAll();if(e.length){for(var h=0;h<e.length;h++){var g=e[h].src.trim();if(g&&g.indexOf("Media.action?")===-1){if(!e[h].hasAttribute("data-storefront-ignore")){var f=d.grid.getStore();if(f.find("url",g)===-1){f.add({url:g,result:"Retrieving...",status:"RETR",temporaryId:""})}}}}}d.processMedia(b)});b.on("change",function(f){if(!d){d=Ext.create("OSF.component.InlineMediaRetrieverWindow",{})}if(!d.programmaticUpdate){a.delay(800)}})});